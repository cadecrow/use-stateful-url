{"version":3,"file":"useStatefulUrl.cjs.js","sources":["../src/useStatefulUrl.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useRef, useMemo } from \"react\";\n\n// Types\nexport interface HashStateOptions<T = Record<string, unknown>> {\n\t/** Delay in ms before updating URL to avoid too frequent updates */\n\tdebounceMs?: number;\n\t/** Whether to use pushState instead of replaceState */\n\tusePushState?: boolean;\n\t/** Custom serializer functions */\n\tserializers?: HashSerializers<T>;\n\t/** Whether to initialize state on mount (default: true) */\n\tinitializeOnMount?: boolean;\n\t/** Delimiters to isolate useStatefulUrl content from existing hash params */\n\tdelimiters?: {\n\t\tstart?: string;\n\t\tend?: string;\n\t};\n\t/** Position strategy for useStatefulUrl content (default: 'end') */\n\tpositionStrategy?: \"preserve\" | \"end\" | \"start\";\n}\n\nexport interface HashSerializers<T = Record<string, unknown>> {\n\t/** Serialize state to URL hash params */\n\tserialize?: (state: T) => Record<string, string>;\n\t/** Deserialize URL hash params to state */\n\tdeserialize?: (params: URLSearchParams) => T;\n}\n\nexport interface useStatefulUrlReturn<T> {\n\t/** Current state */\n\tstate: T;\n\t/** Update state (will also update URL) */\n\tsetState: (newState: T | ((prevState: T) => T)) => void;\n\t/** Whether the hook has been initialized from URL */\n\tisInitialized: boolean;\n\t/** Manually sync current state to URL */\n\tsyncToUrl: () => void;\n\t/** Clear hash from URL and reset to initial state */\n\tclearHash: () => void;\n\t/** Get the current hash without useStatefulUrl content */\n\tgetHashWithoutState: () => string;\n\t/** Get only the useStatefulUrl content from hash */\n\tgetStateFromHash: () => string;\n}\n\n// Utility functions for common serialization patterns\nexport const hashSerializers = {\n\t/** Serialize arrays as comma-separated strings */\n\tstringArray: {\n\t\tserialize: (value: string[]) => value.join(\",\"),\n\t\tdeserialize: (value: string) => (value ? value.split(\",\") : []),\n\t},\n\n\t/** Serialize Set as comma-separated strings */\n\tstringSet: {\n\t\tserialize: (value: Set<string>) => Array.from(value).join(\",\"),\n\t\tdeserialize: (value: string) => new Set(value ? value.split(\",\") : []),\n\t},\n\n\t/** Serialize boolean values */\n\tboolean: {\n\t\tserialize: (value: boolean) => value.toString(),\n\t\tdeserialize: (value: string) => value === \"true\",\n\t},\n\n\t/** Serialize number values */\n\tnumber: {\n\t\tserialize: (value: number) => value.toString(),\n\t\tdeserialize: (value: string) => {\n\t\t\tconst num = Number(value);\n\t\t\treturn isNaN(num) ? 0 : num;\n\t\t},\n\t},\n\n\t/** Serialize objects as JSON */\n\tjson: {\n\t\tserialize: (value: Record<string, unknown>) => JSON.stringify(value),\n\t\tdeserialize: (value: string): Record<string, unknown> | null => {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(value) as Record<string, unknown>;\n\t\t\t} catch {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\t},\n};\n\n// Default serializer for simple objects\nconst defaultSerializer = {\n\tserialize: (state: Record<string, unknown>): Record<string, string> => {\n\t\tconst result: Record<string, string> = {};\n\n\t\tfor (const [key, value] of Object.entries(state)) {\n\t\t\tif (value == null) continue;\n\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\tif (value.length > 0) {\n\t\t\t\t\tresult[key] = value.join(\",\");\n\t\t\t\t}\n\t\t\t} else if (value instanceof Set) {\n\t\t\t\tif (value.size > 0) {\n\t\t\t\t\tresult[key] = Array.from(value).join(\",\");\n\t\t\t\t}\n\t\t\t} else if (typeof value === \"object\") {\n\t\t\t\tresult[key] = JSON.stringify(value);\n\t\t\t} else {\n\t\t\t\tresult[key] = String(value);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tdeserialize: <T extends Record<string, unknown>>(\n\t\tparams: URLSearchParams,\n\t\tinitialState: T\n\t): T => {\n\t\tconst result = { ...initialState };\n\n\t\tfor (const [key, value] of Array.from(params.entries())) {\n\t\t\tif (key in initialState) {\n\t\t\t\tconst initialValue = initialState[key];\n\n\t\t\t\tif (Array.isArray(initialValue)) {\n\t\t\t\t\t(result as Record<string, unknown>)[key] = value\n\t\t\t\t\t\t? value.split(\",\")\n\t\t\t\t\t\t: [];\n\t\t\t\t} else if (initialValue instanceof Set) {\n\t\t\t\t\t(result as Record<string, unknown>)[key] = new Set(\n\t\t\t\t\t\tvalue ? value.split(\",\") : []\n\t\t\t\t\t);\n\t\t\t\t} else if (typeof initialValue === \"boolean\") {\n\t\t\t\t\t(result as Record<string, unknown>)[key] = value === \"true\";\n\t\t\t\t} else if (typeof initialValue === \"number\") {\n\t\t\t\t\tconst num = Number(value);\n\t\t\t\t\t(result as Record<string, unknown>)[key] = isNaN(num)\n\t\t\t\t\t\t? initialValue\n\t\t\t\t\t\t: num;\n\t\t\t\t} else if (typeof initialValue === \"object\" && initialValue !== null) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t(result as Record<string, unknown>)[key] = JSON.parse(\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t) as unknown;\n\t\t\t\t\t} catch {\n\t\t\t\t\t\t(result as Record<string, unknown>)[key] = initialValue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t(result as Record<string, unknown>)[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t},\n};\n\n// Utility functions\nconst isClient = () => typeof window !== \"undefined\";\n\n// Default delimiters for isolating useStatefulUrl content\nconst DEFAULT_DELIMITERS = {\n\tstart: \"__UHS-\",\n\tend: \"-UHS__\",\n};\n\nconst extractStatefulHashParts = (\n\thash: string,\n\tdelimiters = DEFAULT_DELIMITERS\n) => {\n\tconst startDelim = delimiters.start;\n\tconst endDelim = delimiters.end;\n\n\tconst startIndex = hash.indexOf(startDelim);\n\tconst endIndex = hash.indexOf(endDelim);\n\n\tif (startIndex === -1 || endIndex === -1 || endIndex <= startIndex) {\n\t\treturn {\n\t\t\tbefore: hash,\n\t\t\tstatefulHash: \"\",\n\t\t\tafter: \"\",\n\t\t\tdelimiters,\n\t\t};\n\t}\n\n\treturn {\n\t\tbefore: hash.substring(0, startIndex),\n\t\tstatefulHash: hash.substring(startIndex + startDelim.length, endIndex),\n\t\tafter: hash.substring(endIndex + endDelim.length),\n\t\tdelimiters,\n\t};\n};\n\nconst parseStatefulHash = (\n\tdelimiters = DEFAULT_DELIMITERS\n): URLSearchParams => {\n\tif (!isClient()) return new URLSearchParams();\n\n\tconst hash = window.location.hash.substring(1);\n\tconst { statefulHash } = extractStatefulHashParts(hash, delimiters);\n\n\treturn new URLSearchParams(statefulHash);\n};\n\nconst updateStatefulHash = (\n\tparams: Record<string, string>,\n\tusePushState = false,\n\tdelimiters = DEFAULT_DELIMITERS,\n\tpositionStrategy: \"preserve\" | \"end\" | \"start\" = \"end\"\n) => {\n\tif (!isClient()) return;\n\n\tconst currentHash = window.location.hash.substring(1);\n\tconst {\n\t\tbefore,\n\t\tafter,\n\t\tstatefulHash: existingState,\n\t} = extractStatefulHashParts(currentHash, delimiters);\n\n\tconst urlParams = new URLSearchParams();\n\n\t// Only add non-empty values\n\tfor (const [key, value] of Object.entries(params)) {\n\t\tif (value && value.length > 0) {\n\t\t\turlParams.set(key, value);\n\t\t}\n\t}\n\n\tconst stateContent = urlParams.toString();\n\n\t// Reconstruct hash based on position strategy\n\tlet newHash = \"\";\n\n\tif (stateContent) {\n\t\tconst delimitedContent = delimiters.start + stateContent + delimiters.end;\n\n\t\tswitch (positionStrategy) {\n\t\t\tcase \"start\":\n\t\t\t\tnewHash =\n\t\t\t\t\tdelimitedContent +\n\t\t\t\t\t(before || after ? (before || \"\") + (after || \"\") : \"\");\n\t\t\t\tbreak;\n\t\t\tcase \"end\":\n\t\t\t\tconst externalContent = (before || \"\") + (after || \"\");\n\t\t\t\tnewHash =\n\t\t\t\t\texternalContent + (externalContent ? \"\" : \"\") + delimitedContent;\n\t\t\t\tbreak;\n\t\t\tcase \"preserve\":\n\t\t\tdefault:\n\t\t\t\t// Preserve original position, or append to end if first time\n\t\t\t\tif (existingState) {\n\t\t\t\t\t// Replace in original position\n\t\t\t\t\tnewHash = before + delimitedContent + after;\n\t\t\t\t} else {\n\t\t\t\t\t// First time: append to end\n\t\t\t\t\tconst externalContent = (before || \"\") + (after || \"\");\n\t\t\t\t\tnewHash =\n\t\t\t\t\t\texternalContent + (externalContent ? \"\" : \"\") + delimitedContent;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t} else {\n\t\t// No state content, just return external content\n\t\tnewHash = (before || \"\") + (after || \"\");\n\t}\n\n\tconst newUrl = newHash\n\t\t? `#${newHash}`\n\t\t: window.location.pathname + window.location.search;\n\n\tif (usePushState) {\n\t\twindow.history.pushState(null, \"\", newUrl);\n\t} else {\n\t\twindow.history.replaceState(null, \"\", newUrl);\n\t}\n};\n\n// Utility functions for hash manipulation\nexport const hashUtils = {\n\t/** Get the current hash without useStatefulUrl content */\n\tgetHashWithoutState: (delimiters = DEFAULT_DELIMITERS): string => {\n\t\tif (!isClient()) return \"\";\n\n\t\tconst hash = window.location.hash.substring(1);\n\t\tconst { before, after } = extractStatefulHashParts(hash, delimiters);\n\n\t\treturn before + after;\n\t},\n\n\t/** Get only the useStatefulUrl content from hash */\n\tgetStateFromHash: (delimiters = DEFAULT_DELIMITERS): string => {\n\t\tif (!isClient()) return \"\";\n\n\t\tconst hash = window.location.hash.substring(1);\n\t\tconst { statefulHash } = extractStatefulHashParts(hash, delimiters);\n\n\t\treturn statefulHash;\n\t},\n\n\t/** Check if hash contains useStatefulUrl content */\n\thasHashState: (delimiters = DEFAULT_DELIMITERS): boolean => {\n\t\tif (!isClient()) return false;\n\n\t\tconst hash = window.location.hash.substring(1);\n\t\treturn hash.includes(delimiters.start) && hash.includes(delimiters.end);\n\t},\n\n\t/** Safely update the non-useStatefulUrl portion of the hash */\n\tsetExternalHash: (\n\t\tnewExternalHash: string,\n\t\tdelimiters = [DEFAULT_DELIMITERS],\n\t\tusePushState = false\n\t): void => {\n\t\tif (!isClient()) return;\n\n\t\tconst statefulHashes: string[] = [];\n\t\tconst currentHash = window.location.hash.substring(1);\n\t\tfor (const delimiter of delimiters) {\n\t\t\tconst { statefulHash } = extractStatefulHashParts(currentHash, delimiter);\n\t\t\tif (statefulHash) {\n\t\t\t\tstatefulHashes.push(delimiter.start + statefulHash + delimiter.end);\n\t\t\t}\n\t\t}\n\n\t\tconst statefulUrl = statefulHashes.join(\"\");\n\n\t\tlet newHash = newExternalHash;\n\t\tif (statefulUrl) {\n\t\t\t// Add delimiter and useStatefulUrl content to the end for consistency\n\t\t\tnewHash += statefulUrl;\n\t\t}\n\n\t\tconst newUrl = newHash\n\t\t\t? `#${newHash}`\n\t\t\t: window.location.pathname + window.location.search;\n\n\t\tif (usePushState) {\n\t\t\twindow.history.pushState(null, \"\", newUrl);\n\t\t} else {\n\t\t\twindow.history.replaceState(null, \"\", newUrl);\n\t\t}\n\n\t\t// Trigger hashchange event for useStatefulUrl to pick up the change\n\t\twindow.dispatchEvent(new HashChangeEvent(\"hashchange\"));\n\t},\n};\n\n// Debounce utility\nconst useDebounce = <T extends unknown[]>(\n\tcallback: (...args: T) => void,\n\tdelay: number\n) => {\n\tconst timeoutRef = useRef<ReturnType<typeof setTimeout> | undefined>(\n\t\tundefined\n\t);\n\n\treturn useCallback(\n\t\t(...args: T) => {\n\t\t\tif (timeoutRef.current) {\n\t\t\t\tclearTimeout(timeoutRef.current);\n\t\t\t}\n\n\t\t\ttimeoutRef.current = setTimeout(() => {\n\t\t\t\tcallback(...args);\n\t\t\t}, delay);\n\t\t},\n\t\t[callback, delay]\n\t);\n};\n\n/**\n * Custom hook for managing state synchronized with URL hash parameters\n *\n * @param initialState - Initial state object\n * @param options - Configuration options\n * @returns Object with state, setState, and utility functions\n */\nexport function useStatefulUrl<T extends Record<string, unknown>>(\n\tinitialState: T,\n\toptions: HashStateOptions<T> = {}\n): useStatefulUrlReturn<T> {\n\tconst {\n\t\tdebounceMs = 100,\n\t\tusePushState = false,\n\t\tserializers,\n\t\tinitializeOnMount = true,\n\t\tdelimiters = DEFAULT_DELIMITERS,\n\t\tpositionStrategy = \"end\",\n\t} = options;\n\n\t// Ensure delimiters have default values for function calls - memoize to prevent re-renders\n\tconst resolvedDelimiters = useMemo(\n\t\t() => ({\n\t\t\tstart: delimiters.start || DEFAULT_DELIMITERS.start,\n\t\t\tend: delimiters.end || DEFAULT_DELIMITERS.end,\n\t\t}),\n\t\t[delimiters.start, delimiters.end]\n\t);\n\n\tconst [state, setStateInternal] = useState<T>(initialState);\n\tconst [isInitialized, setIsInitialized] = useState(false);\n\tconst isInitializedRef = useRef(false);\n\n\t// Extract serializer functions and their string representations for ESLint\n\tconst serializeFn = serializers?.serialize;\n\tconst deserializeFn = serializers?.deserialize;\n\tconst serializeString = serializeFn?.toString();\n\tconst deserializeString = deserializeFn?.toString();\n\n\t// Memoize serializers to prevent infinite re-renders when defined inline\n\tconst memoizedSerializers = useMemo(() => {\n\t\tif (!serializeFn && !deserializeFn) return null;\n\n\t\t// Create stable references for the serializer functions\n\t\treturn { serialize: serializeFn, deserialize: deserializeFn };\n\t\t// preventing linter ignore for now - eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [serializeString, deserializeString]);\n\n\t// Use memoized serializers if provided, otherwise use default\n\tconst serialize = useMemo(() => {\n\t\treturn memoizedSerializers?.serialize || defaultSerializer.serialize;\n\t}, [memoizedSerializers?.serialize]);\n\tconst deserialize = useMemo(() => {\n\t\treturn (\n\t\t\tmemoizedSerializers?.deserialize ||\n\t\t\t((params: URLSearchParams) =>\n\t\t\t\tdefaultSerializer.deserialize(params, initialState))\n\t\t);\n\t}, [memoizedSerializers?.deserialize, initialState]);\n\n\t// Debounced URL update function - memoize the callback to prevent infinite re-renders\n\tconst updateHashCallback = useCallback(\n\t\t(newState: T) => {\n\t\t\tif (!isInitializedRef.current) return;\n\n\t\t\tconst serialized = serialize(newState);\n\t\t\tupdateStatefulHash(\n\t\t\t\tserialized,\n\t\t\t\tusePushState,\n\t\t\t\tresolvedDelimiters,\n\t\t\t\tpositionStrategy\n\t\t\t);\n\t\t},\n\t\t[serialize, usePushState, resolvedDelimiters, positionStrategy]\n\t);\n\n\tconst debouncedUpdateHash = useDebounce(updateHashCallback, debounceMs);\n\n\t// Initialize state from URL hash on mount\n\tuseEffect(() => {\n\t\tif (!initializeOnMount || !isClient()) {\n\t\t\tsetIsInitialized(true);\n\t\t\tisInitializedRef.current = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = parseStatefulHash(resolvedDelimiters);\n\t\tconst initializedState = deserialize(params);\n\n\t\tsetStateInternal(initializedState);\n\t\tsetIsInitialized(true);\n\t\tisInitializedRef.current = true;\n\t}, [initializeOnMount, deserialize, resolvedDelimiters]);\n\n\t// Update URL when state changes (only after initialization)\n\tuseEffect(() => {\n\t\tif (!isInitialized) return;\n\t\tdebouncedUpdateHash(state);\n\t}, [state, isInitialized, debouncedUpdateHash]);\n\n\t// Handle browser navigation\n\tuseEffect(() => {\n\t\tif (!isClient() || !isInitialized) return;\n\n\t\tconst handleHashChange = () => {\n\t\t\tconst params = parseStatefulHash(resolvedDelimiters);\n\t\t\tconst newState = deserialize(params);\n\t\t\tsetStateInternal(newState);\n\t\t};\n\n\t\twindow.addEventListener(\"hashchange\", handleHashChange);\n\t\treturn () => window.removeEventListener(\"hashchange\", handleHashChange);\n\t}, [isInitialized, deserialize, resolvedDelimiters]);\n\n\t// State setter function\n\tconst setState = useCallback((newState: T | ((prevState: T) => T)) => {\n\t\tsetStateInternal((prev) => {\n\t\t\tconst nextState =\n\t\t\t\ttypeof newState === \"function\"\n\t\t\t\t\t? (newState as (prevState: T) => T)(prev)\n\t\t\t\t\t: newState;\n\t\t\treturn nextState;\n\t\t});\n\t}, []);\n\n\t// Utility functions\n\tconst syncToUrl = useCallback(() => {\n\t\tconst serialized = serialize(state);\n\t\tupdateStatefulHash(serialized, usePushState, resolvedDelimiters, positionStrategy);\n\t}, [state, serialize, usePushState, resolvedDelimiters, positionStrategy]);\n\n\tconst clearHash = useCallback(() => {\n\t\tif (!isClient()) return;\n\n\t\t// Clear only the useStatefulUrl portion, preserve existing hash content\n\t\tconst currentHash = window.location.hash.substring(1);\n\t\tconst { before, after } = extractStatefulHashParts(currentHash, resolvedDelimiters);\n\t\tconst newHash = before + after;\n\n\t\tconst newUrl = newHash\n\t\t\t? `#${newHash}`\n\t\t\t: window.location.pathname + window.location.search;\n\t\twindow.history.replaceState(null, \"\", newUrl);\n\t\tsetStateInternal(initialState);\n\t}, [initialState, resolvedDelimiters]);\n\n\tconst getHashWithoutState = useCallback(() => {\n\t\treturn hashUtils.getHashWithoutState(resolvedDelimiters);\n\t}, [resolvedDelimiters]);\n\n\tconst getStateFromHash = useCallback(() => {\n\t\treturn hashUtils.getStateFromHash(resolvedDelimiters);\n\t}, [resolvedDelimiters]);\n\n\treturn {\n\t\tstate,\n\t\tsetState,\n\t\tisInitialized,\n\t\tsyncToUrl,\n\t\tclearHash,\n\t\tgetHashWithoutState,\n\t\tgetStateFromHash,\n\t};\n}\n\n// Convenience hooks for common patterns\nexport function useStatefulUrlArray<T extends string>(\n\tkey: string,\n\tinitialValue: T[] = [],\n\tvalidValues?: T[]\n) {\n\tconst initialState = { [key]: initialValue };\n\n\tconst options: HashStateOptions<typeof initialState> = {\n\t\tserializers: {\n\t\t\tserialize: (state) => ({\n\t\t\t\t[key]: state[key]?.length > 0 ? state[key].join(\",\") : \"\",\n\t\t\t}),\n\t\t\tdeserialize: (params) => {\n\t\t\t\tconst value = params.get(key);\n\t\t\t\tconst array = value ? value.split(\",\") : [];\n\t\t\t\tconst filtered = validValues\n\t\t\t\t\t? array.filter((item) => validValues.includes(item as T))\n\t\t\t\t\t: array;\n\t\t\t\treturn { [key]: filtered as T[] };\n\t\t\t},\n\t\t},\n\t};\n\n\tconst { state, setState, ...rest } = useStatefulUrl(initialState, options);\n\n\treturn {\n\t\tvalue: state[key] as T[],\n\t\tsetValue: (newValue: T[] | ((prev: T[]) => T[])) => {\n\t\t\tsetState((prev) => ({\n\t\t\t\t...prev,\n\t\t\t\t[key]: typeof newValue === \"function\" ? newValue(prev[key]) : newValue,\n\t\t\t}));\n\t\t},\n\t\t...rest,\n\t};\n}\n\nexport function useStatefulUrlSet<T extends string>(\n\tkey: string,\n\tinitialValue: Set<T> = new Set(),\n\tvalidValues?: T[]\n) {\n\tconst initialState = { [key]: initialValue };\n\n\tconst options: HashStateOptions<typeof initialState> = {\n\t\tserializers: {\n\t\t\tserialize: (state) => ({\n\t\t\t\t[key]: state[key]?.size > 0 ? Array.from(state[key]).join(\",\") : \"\",\n\t\t\t}),\n\t\t\tdeserialize: (params) => {\n\t\t\t\tconst value = params.get(key);\n\t\t\t\tconst array = value ? value.split(\",\") : [];\n\t\t\t\tconst filtered = validValues\n\t\t\t\t\t? array.filter((item) => validValues.includes(item as T))\n\t\t\t\t\t: array;\n\t\t\t\treturn { [key]: new Set(filtered as T[]) };\n\t\t\t},\n\t\t},\n\t};\n\n\tconst { state, setState, ...rest } = useStatefulUrl(initialState, options);\n\n\treturn {\n\t\tvalue: state[key] as Set<T>,\n\t\tsetValue: (newValue: Set<T> | ((prev: Set<T>) => Set<T>)) => {\n\t\t\tsetState((prev) => ({\n\t\t\t\t...prev,\n\t\t\t\t[key]: typeof newValue === \"function\" ? newValue(prev[key]) : newValue,\n\t\t\t}));\n\t\t},\n\t\t...rest,\n\t};\n}\n\nexport function useStatefulUrlString(key: string, initialValue: string = \"\") {\n\tconst initialState = { [key]: initialValue };\n\n\tconst { state, setState, ...rest } = useStatefulUrl(initialState);\n\n\treturn {\n\t\tvalue: state[key] as string,\n\t\tsetValue: (newValue: string | ((prev: string) => string)) => {\n\t\t\tsetState((prev) => ({\n\t\t\t\t...prev,\n\t\t\t\t[key]: typeof newValue === \"function\" ? newValue(prev[key]) : newValue,\n\t\t\t}));\n\t\t},\n\t\t...rest,\n\t};\n}\n"],"names":["useRef","useCallback","useMemo","useState","useEffect"],"mappings":"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"}